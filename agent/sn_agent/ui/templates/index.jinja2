<html>

<head>

</head>

<body>

<button onclick="sendCanPerform()">Can Perform</button>
<br>
<button onclick="sendPerform()">Perform</button>
<br>
<button onclick="sendPerformMNIST()">Perform MNIST Classification</button>
<br>

<script>
    var ws = new WebSocket('ws://localhost:9050/api/ws');

    // A 28 x 28 image of a 7 which has been flattened into a single float 784-element vector format
    // as required by the tensorflow mnist adapter.

    var received_msg = "";

    ws.onopen = function () {
        // Web Socket is connected, send data using send()
        //ws.send("Message to send");
        console.log('Connection Opened');
    };

    ws.onmessage = function (evt) {
        received_msg = evt.data;
        console.log(received_msg);
    };

    ws.onclose = function () {
        console.log("Connection is closed...");
    };

    window.onbeforeunload = function (event) {
        socket.close();
    };

    ws.onerror = function (a, b, c, d) {
        console.log(a);
        console.log(b);
        console.log(c);
        console.log(d);
    };

    function sendCanPerform() {

        var request = {
            "jsonrpc": "2.0",
            "method": "can_perform",
            "params": {
                "service_node_id": "deadbeef-aaaa-bbbb-cccc-000000000001"
            },
            "id": 3
        };
        ws.send(JSON.stringify(request));
    }

    function sendPerform() {

        var request = {
            "jsonrpc": "2.0",
            "method": "perform",
            "params": {
                "service_node_id": "deadbeef-aaaa-bbbb-cccc-000000000001",
                "job_params":
                    [
                        {
                            "input_type": "file",
                            "input_url": "http://test.com/inputs/test_input.txt",
                            "output_type": "file_url_put",
                            "output_url": "test_output.txt"
                        }
                    ]
            },
            "id": 3
        };
        ws.send(JSON.stringify(request));

    }

    function sendPerformMNIST() {

        var request = {
            "jsonrpc": "2.0",
            "method": "perform",
            "params": {
                "service_node_id": "deadbeef-aaaa-bbbb-cccc-111111111101",
                "job_params":
                    [
                        {
                            "input_type": "attached",
                            "input_data": {
                                "images": [

                                    [
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.32941177, 0.72549021, 0.62352943, 0.59215689, 0.23529413, 0.14117648,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0.8705883, 0.99607849, 0.99607849, 0.99607849, 0.99607849,
                                        0.9450981, 0.77647066, 0.77647066, 0.77647066, 0.77647066, 0.77647066,
                                        0.77647066, 0.77647066, 0.77647066, 0.66666669, 0.20392159, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0.26274511, 0.44705886, 0.28235295,
                                        0.44705886, 0.63921571, 0.89019614, 0.99607849, 0.88235301, 0.99607849,
                                        0.99607849, 0.99607849, 0.98039222, 0.89803928, 0.99607849, 0.99607849,
                                        0.54901963, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0.06666667, 0.25882354,
                                        0.05490196, 0.26274511, 0.26274511, 0.26274511, 0.23137257, 0.08235294,
                                        0.92549026, 0.99607849, 0.41568631, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.32549021, 0.99215692, 0.81960791, 0.07058824, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.08627451, 0.91372555, 1., 0.32549021, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0.50588238, 0.99607849, 0.9333334, 0.17254902, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.23137257, 0.97647065, 0.99607849, 0.24313727, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0.52156866, 0.99607849, 0.73333335, 0.01960784, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.03529412, 0.80392164, 0.97254908, 0.227451, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0.49411768, 0.99607849, 0.71372551, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.29411766, 0.98431379, 0.94117653, 0.22352943, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.07450981, 0.86666673, 0.99607849, 0.65098041, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.01176471, 0.7960785, 0.99607849, 0.8588236, 0.13725491, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0.14901961, 0.99607849, 0.99607849, 0.3019608, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.12156864, 0.87843144, 0.99607849, 0.45098042, 0.00392157, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0.52156866, 0.99607849, 0.99607849, 0.20392159, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0.2392157,
                                        0.94901967, 0.99607849, 0.99607849, 0.20392159, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0,
                                        0.47450984, 0.99607849, 0.99607849, 0.8588236, 0.15686275, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0.47450984, 0.99607849, 0.81176478, 0.07058824, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0, 0, 0, 0,
                                        0, 0, 0, 0
                                    ]

                                ]
                            },
                            "output_type": "attached"
                        }
                    ]
            },
            "id": 3
        };
        ws.send(JSON.stringify(request));
    }

</script>

</body>
</html>
